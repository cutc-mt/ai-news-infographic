<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDBハイブリッド検索RAGエージェント・Pydantic AI・Dockling</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=Yomogi&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --ui-color-1: #667eea;
            --ui-color-2: #764ba2;
            --ui-color-3: #f093fb;
            --ui-color-4: #4facfe;
            --ui-color-5: #00f2fe;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
            font-weight: 400;
        }

        .date {
            margin-top: 10px;
            opacity: 0.9;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: fadeInScale 0.6s ease-out backwards;
        }

        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }
        .card:nth-child(5) { animation-delay: 0.5s; }
        .card:nth-child(6) { animation-delay: 0.6s; }
        .card:nth-child(7) { animation-delay: 0.7s; }
        .card:nth-child(8) { animation-delay: 0.8s; }
        .card:nth-child(9) { animation-delay: 0.9s; }
        .card:nth-child(10) { animation-delay: 1.0s; }
        .card:nth-child(11) { animation-delay: 1.1s; }
        .card:nth-child(12) { animation-delay: 1.2s; }
        .card:nth-child(13) { animation-delay: 1.3s; }
        .card:nth-child(14) { animation-delay: 1.4s; }
        .card:nth-child(15) { animation-delay: 1.5s; }
        .card:nth-child(16) { animation-delay: 1.6s; }
        .card:nth-child(17) { animation-delay: 1.7s; }
        .card:nth-child(18) { animation-delay: 1.8s; }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--ui-color-1), var(--ui-color-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card h3 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .card p {
            color: #666;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        footer {
            text-align: center;
            color: white;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        footer a {
            color: white;
            text-decoration: none;
            font-weight: 700;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @media (max-width: 1600px) {
            .grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
        }

        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
            h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 900px) {
            .grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
            h1 {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            h1 {
                font-size: 1.5rem;
            }
            .subtitle {
                font-size: 1rem;
            }
            .card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MongoDBハイブリッド検索RAGエージェント・Pydantic AI・Dockling</h1>
            <p class="subtitle">セマンティック検索・キーワード検索・相互ランク融合・本番環境対応</p>
            <p class="date">2025年12月11日</p>
        </header>

        <div class="grid">
            <div class="card">
                <div class="card-icon"><i class="fas fa-rocket"></i></div>
                <h3>ハイブリッド検索RAG概要</h3>
                <p>セマンティック検索+キーワード検索を組み合わせた本番環境対応RAGシステム。MongoDB・Pydantic AI・Dockling統合。意味理解の深さ+正確なキーワードマッチング。両方の長所を活用。GitHubテンプレート公開。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-balance-scale"></i></div>
                <h3>セマンティック vs キーワード検索</h3>
                <p>セマンティック検索:意味・文脈理解。「自動車修理」→「車両メンテナンス」も検出。キーワード検索:正確なマッチング重視。専門用語・製品番号・コード名に最適。ハイブリッドで両方の強みを実現。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-database"></i></div>
                <h3>MongoDB Atlas Vector Search</h3>
                <p>ベクトル検索+全文検索を単一データベースで実現。別データベース不要。セットアップ簡単。コレクション作成→ベクトル検索インデックス作成→全文検索インデックス作成。3ステップで完了。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-file-alt"></i></div>
                <h3>Dockling・ドキュメント解析</h3>
                <p>高品質ドキュメント解析ライブラリ。PDF・画像・DOCX対応。テキスト抽出・構造認識。テーブル・リスト・見出し正確保存。複雑レイアウトも処理。MongoDBにドキュメント保存。埋め込みベクトル生成。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-brain"></i></div>
                <h3>Pydantic AI・型安全エージェント</h3>
                <p>LLM駆動エージェントフレームワーク。型安全・構造化出力保証。Pythonネイティブ。Pydanticモデルで応答検証。ツール呼び出し管理。システムプロンプト定義。RAGツール統合簡単。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-project-diagram"></i></div>
                <h3>システムアーキテクチャ</h3>
                <p>ユーザー質問→クエリ分解→2並列パイプライン実行。パイプライン1:セマンティック検索(ベクトル類似性)。パイプライン2:キーワード検索(全文検索+ファジーマッチング)。結果→相互ランク融合→再ランキング→LLM回答生成。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-cut"></i></div>
                <h3>クエリ分解・Query Decomposition</h3>
                <p>複雑質問→小さなサブクエリ分解。「製品Xの価格と在庫状況教えて」→「製品Xの価格」「製品Xの在庫」。各サブクエリ独立検索→結果統合。検索精度向上。複数観点から情報収集。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-vector-square"></i></div>
                <h3>埋め込みモデル・Text Embedding 3 Small</h3>
                <p>OpenAI Text Embedding 3 Smallモデル使用。テキスト→高次元ベクトル変換。意味的類似性を数値化。MongoDB Atlas Vector Searchで類似ドキュメント検索。コスト効率・高速・高精度。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-search"></i></div>
                <h3>全文検索・Fuzzy Matching</h3>
                <p>MongoDB全文検索インデックス活用。正確なキーワードマッチング。Fuzzy Matching:スペルミス許容。「accomodation」→「accommodation」検出。タイポ・バリエーションに強い。専門用語検索で威力発揮。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-trophy"></i></div>
                <h3>相互ランク融合・RRF</h3>
                <p>Reciprocal Rank Fusion。2つの検索結果を統合。各結果のランク位置から相互スコア計算。セマンティック上位+キーワード上位→総合ランキング作成。公平な結果統合。両検索の強み活用。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-filter"></i></div>
                <h3>クロスエンコーダー再ランキング</h3>
                <p>最終精度向上ステップ。RRF結果→クロスエンコーダーで再評価。質問とドキュメントを同時エンコード→関連性スコア算出。最も関連性高いドキュメント選択。LLMに渡す前の品質保証。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-bolt"></i></div>
                <h3>バイエンコーダー vs クロスエンコーダー</h3>
                <p>バイエンコーダー:質問・ドキュメント別々エンコード→ベクトル比較。高速・大規模検索向き。クロスエンコーダー:質問+ドキュメント同時処理→直接関連性評価。低速・高精度。ハイブリッドで両方活用。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-code"></i></div>
                <h3>MongoDBアグリゲーションパイプライン</h3>
                <p>複雑検索クエリを段階的処理。$vectorSearch:ベクトル類似性検索。$search:全文検索実行。$project:フィールド選択・スコア計算。$limit:結果数制限。強力なデータ処理機能。単一クエリで複雑操作。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-tools"></i></div>
                <h3>Pydantic AIツール定義</h3>
                <p>@agent.toolデコレータでRAGツール定義。型ヒント・docstring→自動ツール説明生成。LLMがツール使用判断。引数自動検証。戻り値型安全。エージェント統合シンプル。Pythonらしいコード。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-comments"></i></div>
                <h3>会話履歴管理</h3>
                <p>ユーザー質問・エージェント応答を保存。文脈維持・follow-up質問対応。「それについてもっと教えて」等の代名詞解決。会話フロー自然。長い対話でも文脈維持。履歴をLLMに渡す。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-tachometer-alt"></i></div>
                <h3>パフォーマンス最適化</h3>
                <p>2つの検索パイプライン並列実行→速度低下なし。MongoDBインデックス活用→高速検索。埋め込みキャッシュ→重複計算回避。効率的バッチ処理。本番環境で実証済み。大規模データでもスケール。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-cogs"></i></div>
                <h3>実装の柔軟性</h3>
                <p>各コンポーネント独立設計。埋め込みモデル変更可能。LLMプロバイダー切り替え簡単。検索パラメータ調整可能。クロスエンコーダーモデル選択自由。カスタマイズ容易。ユースケースに合わせて調整。</p>
            </div>

            <div class="card">
                <div class="card-icon"><i class="fas fa-rocket"></i></div>
                <h3>本番環境準備完了・GitHubテンプレート</h3>
                <p>完全な本番環境対応コード。エラーハンドリング・ログ・監視実装済み。GitHubでテンプレート公開。クローン→環境変数設定→実行。ドキュメント完備。即座にプロジェクト開始可能。ハイブリッド検索RAGのベストプラクティス。</p>
            </div>
        </div>

        <footer>
            <p><i class="fab fa-youtube"></i> 元動画: <a href="https://www.youtube.com/watch?v=Tz2YXg61aPo" target="_blank">https://www.youtube.com/watch?v=Tz2YXg61aPo</a></p>
        </footer>
    </div>
</body>
</html>
